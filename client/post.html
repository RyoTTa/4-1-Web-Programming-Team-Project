<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>나눔 해요 글 등록하기</title>

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/shop-homepage.css" rel="stylesheet">
    <!-- Bootstrap core JavaScript -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script>
        $(document).on('click', '#btnSave', function (e) {
            e.preventDefault();
            $("#form").submit();
        });

        $(document).on('click', '#btnList', function (e) {
            e.preventDefault();
            location.href = "${pageContext.request.contextPath}/board/getBoardList";
        });

    </script>



    <style>
        .comment_item {
            width: 100%;
            height: 30%;

            display: flex;
            flex-direction: column;
            background-color: indianred;
        }

        .comment_info {
            display: flex;
            flex-direction: row;
            height: 30%;
            margin-top: 10px;
            background-color: gray;
        }

        .comment_name {
            font-size: 20px;
            margin-left: 15px;
            background-color: khaki;
        }

        .comment_date {
            font-size: 15px;
            margin-left: 20px;
        }

        .comment_content {
            font-size: 18px;
            padding: 20px;
        }
    </style>
</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
            <img src="./images/LOGO.png" style="width: 40px; height: 40px;">
            <a class="navbar-brand" href="home.html">&nbsp다 ~ 주라</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive"
                aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item active">
                        <a class="nav-link" href="home.html">Home
                            <span class="sr-only">(current)</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="mypage.html">My Page</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="chat.html">Chatting</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">Logout</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Page Content -->
    <div class="container">

        <div class="row">

            <div class="col-lg-3">

                <h1 class="my-4">Menu</h1>
                <div class="list-group">
                    <a class="list-group-item" id="menu_output">나눔 해요</a>
                    <a class="list-group-item" id="menu_input">나눔 받아요</a>
                </div>

            </div>
            <!-- /.col-lg-3 -->

            <div class="col-lg-9">
                <div>
                    <article style="margin-top: 100px; padding-bottom:10px;">

                        <div class="container" role="main">

                            <h2 id="post_title">게시글 제목</h2>

                            <form name="form" id="form" role="form" method="post"
                                action="${pageContext.request.contextPath}/board/saveBoard">
                                <div class="mb-3">

                                    <div id="post_username" style="width:80%; border-color: black;">작성자</div>
                                </div>
                                <div class="mb-3">

                                    <div id="post_time" style="width:80%; border-color: black;">작성일</div>
                                </div>
                                <div class="mb-3">

                                    <div id="post_location" style="width:80%; border-color: black;">위치정보들어갈 장소</div>
                                </div>

                                <div
                                    style="width:100%; margin : 0 auto; background-color: rgb(240, 240, 240);">
                                    <image id="post_image" style = "width:80%;">
                                    </image>
                                </div>

                                <div class="mb-3" style="margin-top:30px;">

                                    <div id="post_contents" class="jumbotron"
                                        style="background-color: rgb(240, 240, 240);">게시글 내용</div>

                                </div>

                                <div style="float:right;">
                                    <button type="button" class="btn btn-sm btn-primary" id="btnList">목록</button>
                                </div>

                                <div class="mb-3">

                                    <label for="content">댓글 입력</label>

                                    <div style="display:flex; flex-direction: row;">
                                        <textarea class="form-control" rows="5" name="content" id="content"
                                            placeholder="댓글을 입력해 주세요" style="width:80%; height:20%;"></textarea>
                                        <button type="button" class="btn btn-sm btn-primary"
                                            style="height:80px; width: 80px; margin-left:20px; margin-top:27px;">입력
                                        </button>
                                    </div>

                                </div>

                            </form>



                            <div style="margin-top:70px;background-color:gray; display:flex; flex-direction: column;">
                                <div class="comment_item">
                                    <div class="comment_info">
                                        <div class="comment_name">이름</div>
                                        <div class="comment_date">20/07/01</div>
                                    </div>
                                    <div class="comment_content">댓글 내용</div>
                                </div>
                            </div>



                        </div>

                    </article>

                </div>


            </div>
            <!-- /.col-lg-9 -->

        </div>
        <!-- /.row -->

    </div>
    <!-- /.container -->

    <!-- Footer -->
    <footer class="py-5 bg-dark">
        <div class="container">
            <p class="m-0 text-center text-white">Copyright &copy; Your Website 2020</p>
        </div>
        <!-- /.container -->
    </footer>

    <script src="https://www.gstatic.com/firebasejs/4.10.1/firebase.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.2.3/firebase-firestore.js"></script>
    <script>
        function getUrlParams() {
            var params = {};
            window.location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi, function (str, key, value) { params[key] = value; });
            return params;
        }
        var oParams = getUrlParams();
        var uid = oParams.uid;
        var func = oParams.func;
        var postid = oParams.postid;

        var firebaseConfig = {
            apiKey: "AIzaSyCweXAFVhwjG8cglNBGgGkelKW4trxFUxM",
            authDomain: "webproject-cc0c8.firebaseapp.com",
            databaseURL: "https://webproject-cc0c8.firebaseio.com",
            storageBucket: "webproject-cc0c8.appspot.com",
            projectId: "webproject-cc0c8"
        };
        firebase.initializeApp(firebaseConfig);

        var storage = firebase.storage();
        var storageRef = storage.ref();

        var db = firebase.firestore();
        var outputRef = db.collection("output").doc(postid);

        outputRef.get().then(function (doc) {
            docdata = doc.data();
            console.log(doc.data());
            var datee = new Date((docdata.time.seconds * 1000) + (docdata.time.nanoseconds / 1000000));
          
            $("#post_time").text((datee.getMonth()+1)+"월 "+datee.getDate()+"일 "+datee.getHours()+"시");
            $("#post_title").text(doc.data().title);
            $("#post_username").text(doc.data().username);
            $("#post_location").text(doc.data().location._lat + " " + doc.data().location._long);
            $("#post_contents").text(doc.data().contents);

            var starsRef = storageRef.child(docdata.image);
            console.log(docdata.image);
            starsRef.getDownloadURL().then(function (url) {
                $("#post_image").attr("src", url);
            }).catch(function (error) {

                switch (error.code) {
                    case 'storage/object-not-found':
                        // File doesn't exist
                        break;

                    case 'storage/unauthorized':
                        // User doesn't have permission to access the object
                        break;

                    case 'storage/canceled':
                        // User canceled the upload
                        break;

                    case 'storage/unknown':
                        // Unknown error occurred, inspect the server response
                        break;
                }

            });

        });








    </script>
    <script>
        $("#menu_output").click(function () {
            window.location.href = "./board_output.html?" + "uid=" + uid;
        });

        $("#menu_input").click(function () {
            window.location.href = "./board_input.html?" + "uid=" + uid;
        });
    </script>
</body>

</html>